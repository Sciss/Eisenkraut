<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<title></title>
<meta name="Generator" content="Cocoa HTML Writer">
<meta name="CocoaVersion" content="824.48">
<style type="text/css">
p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco; color: #bf0000}
p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco; color: #000000; min-height: 12.0px}
p.p3 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco; color: #000000}
p.p4 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco; color: #007300}
p.p5 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco; color: #606060}
span.s1 {color: #0000bf}
span.s2 {color: #606060}
span.s3 {color: #007300}
span.s4 {color: #000000}
span.Apple-tab-span {white-space:pre}
</style>
</head>
<body>
<p class="p1">// lastmod: 02-Jan-09</p>
<p class="p2"><br></p>
<p class="p3">(</p>
<p class="p3">e = <span class="s1">Eisenkraut</span>.default;</p>
<p class="p3">e.connect;</p>
<p class="p3">fork { e.initTree; e.initSwing };</p>
<p class="p3">)</p>
<p class="p2"><br></p>
<p class="p1">// WARNING : fails if scsynth wasn't yet booted!</p>
<p class="p2"><br></p>
<p class="p1">// Example of a realtime plug-in:</p>
<p class="p1">// Inserts a synth in the master group</p>
<p class="p1">// that converts input M-S (mid-side) signals</p>
<p class="p1">// into X-Y signals. For simplicity, this</p>
<p class="p1">// just does it in audio output bus of the active document.</p>
<p class="p1">//<span class="Apple-converted-space"> </span></p>
<p class="p1">// for technical details see http://emusician.com/mag/emusic_front_center/</p>
<p class="p1">//<span class="Apple-converted-space"> </span></p>
<p class="p1">// Note that a new menu item appears in</p>
<p class="p1">// Process -&gt; SuperCollider.</p>
<p class="p1">// Choosing this item will execute</p>
<p class="p1">// the populateWindowFunc function</p>
<p class="p1">// below.</p>
<p class="p3">(</p>
<p class="p3"><span class="s1">var</span> def, synth;</p>
<p class="p2"><br></p>
<p class="p3">x = <span class="s1">EisKPlugIn</span>.new.name_( <span class="s2">"M-S Decoder"</span> );</p>
<p class="p3">e.addProcessPlugIn( x );</p>
<p class="p3">fork { e.initTree };</p>
<p class="p2"><br></p>
<p class="p3">def = <span class="s1">SynthDef</span>( <span class="s3">\msDecoder</span>, { <span class="s1">arg</span> bus = 0, midAmp = 1.0, sideAmp = 1.0;</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="s1">var</span> mid, side, left, right;</p>
<p class="p3"><span class="Apple-tab-span">	</span>#mid, side = <span class="s1">In</span>.ar( bus, 2 );</p>
<p class="p3"><span class="Apple-tab-span">	</span>mid<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>= mid * midAmp;</p>
<p class="p3"><span class="Apple-tab-span">	</span>side<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>= side * sideAmp;</p>
<p class="p3"><span class="Apple-tab-span">	</span>left<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>= mid + side;</p>
<p class="p3"><span class="Apple-tab-span">	</span>right<span class="Apple-tab-span">	</span>= mid - side;</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="s1">ReplaceOut</span>.ar( bus, [ left, right ]);</p>
<p class="p3">});</p>
<p class="p2"><br></p>
<p class="p3">x.populateWindowFunc = { <span class="s1">arg</span> plug, win;</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="s1">var</span> flow, gui, ggSideGain, lbSideGain, ggBypass, spec, sideAmp = 1.0, bypass = <span class="s1">true</span>, cond, keepGoing = <span class="s1">true</span>;</p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p3"><span class="Apple-tab-span">	</span>gui = <span class="s1">GUI</span>.current;</p>
<p class="p3"><span class="Apple-tab-span">	</span>win.bounds_( win.bounds.resizeTo( 360, 60 ));</p>
<p class="p2"><span class="Apple-tab-span">	</span></p>
<p class="p3"><span class="Apple-tab-span">	</span>flow = <span class="s1">FlowLayout</span>( win.view.bounds );</p>
<p class="p3"><span class="Apple-tab-span">	</span>win.view.decorator = flow;</p>
<p class="p2"><span class="Apple-tab-span">	</span></p>
<p class="p3"><span class="Apple-tab-span">	</span>spec = <span class="s1">Spec</span>.specs[ <span class="s3">\boostcut</span> ];</p>
<p class="p3"><span class="Apple-tab-span">	</span>cond = <span class="s1">Condition</span>.new;</p>
<p class="p3"><span class="Apple-tab-span">	</span>fork { <span class="s1">var</span> msg, diskBus, grpInput;</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>while({ keepGoing }, {</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>cond.wait; cond.test = <span class="s1">false</span>;</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if( synth.notNil, {</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>synth.free; synth = <span class="s1">nil</span>;</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>});</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if( bypass.not, {</p>
<p class="p4"><span class="s4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>msg = e.query( </span>'/doc/active/sc'<span class="s4">, [ </span>\diskBusIndex<span class="s4">, </span>\diskBusNumChannels<span class="s4">, </span>\inputGroup<span class="s4"> ]);</span></p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if( msg.notNil, {</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>diskBus <span class="Apple-tab-span">	</span>= <span class="s1">Bus</span>( <span class="s3">\audio</span>, msg[ 0 ], msg[ 1 ], e.scsynth );</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>grpInput<span class="Apple-tab-span">	</span>= <span class="s1">Group</span>.basicNew( e.scsynth, msg[ 2 ]);</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>def.send( e.scsynth );</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>e.scsynth.sync;</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>synth = <span class="s1">Synth</span>( <span class="s3">\msDecoder</span>, [ <span class="s3">\bus</span>, diskBus.index, <span class="s3">\sideAmp</span>, sideAmp ], grpInput, <span class="s3">\addAfter</span> );</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}, {</p>
<p class="p5"><span class="s4"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>"OSC Timeout!"<span class="s4">.error;</span></p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>});</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>});</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>});</p>
<p class="p3"><span class="Apple-tab-span">	</span>};</p>
<p class="p2"><span class="Apple-tab-span">	</span></p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="s1">GUI</span>.staticText.new( win, <span class="s1">Rect</span>( 0, 0, 60, 24 ))</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>.align_( <span class="s3">\right</span> )</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>.string_( <span class="s2">"Side Gain"</span> );</p>
<p class="p2"><br></p>
<p class="p3"><span class="Apple-tab-span">	</span>ggSideGain = <span class="s1">GUI</span>.slider.new( win, <span class="s1">Rect</span>( 0, 0, 240, 20 ))</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>.value_( spec.unmap( 0 ))</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>.action_({ <span class="s1">arg</span> b; <span class="s1">var</span> db;</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>db = spec.map( b.value );</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>lbSideGain.string = db.round( 0.1 ).asString + <span class="s2">"dB"</span>;</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>sideAmp = db.dbamp;</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if( synth.notNil, { synth.set( <span class="s3">\sideAmp</span>, sideAmp )});</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>});</p>
<p class="p3"><span class="Apple-tab-span">	</span>lbSideGain = <span class="s1">GUI</span>.staticText.new( win, <span class="s1">Rect</span>( 0, 0, 60, 24 ))</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>.string_( <span class="s2">"0 dB"</span> );</p>
<p class="p2"><br></p>
<p class="p3"><span class="Apple-tab-span">	</span>flow.nextLine;</p>
<p class="p2"><br></p>
<p class="p3"><span class="Apple-tab-span">	</span>ggBypass = gui.button.new( win, <span class="s1">Rect</span>( 0, 0, 80, 24 ))</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>.states_([[ <span class="s2">"Bypass"</span> ], [ <span class="s2">"Bypass"</span>, <span class="s1">Color</span>.black, <span class="s1">Color</span>.yellow ]])</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>.value_( 1 )</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>.action_({ <span class="s1">arg</span> b;</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>bypass = b.value == 1;</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>cond.test = <span class="s1">true</span>; cond.signal;</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>});</p>
<p class="p3"><span class="Apple-tab-span">	</span>ggBypass.onClose = { keepGoing = <span class="s1">false</span>; bypass = <span class="s1">true</span>; cond.test = <span class="s1">true</span>; cond.signal };</p>
<p class="p2"><span class="Apple-tab-span">	</span></p>
<p class="p3">};</p>
<p class="p3">)</p>
</body>
</html>
